var google=google||{},Modernizr=Modernizr||{},Ws={lastHash:"",highlightSelected:function(){var e=!1;$("section").each(function(t){var n="#"+$(this).attr("id");if(n===Ws.lastHash){$("nav a.active").removeClass("active");$("nav a").eq(t).addClass("active");e=!0;return!1}});return e},checkVisible:function(e){var t=$(window),n={top:t.scrollTop(),left:t.scrollLeft()};n.right=n.left+t.width();n.bottom=n.top+t.height();var r=e.offset();r.right=r.left+e.outerWidth();r.bottom=r.top+e.outerHeight();return!(n.right<r.left||n.left>r.right||n.bottom<r.top||n.top>r.bottom)},parallax:function(){$.each($(".parallax"),function(e,t){var n=$(window).scrollTop();if(Ws.checkVisible($(t))){var r=-($(t).offset().top-n)*.4;$(t).css("top",r+"px")}})},initializeMaps:function(){var e=function(e,t){var n=new google.maps.InfoWindow,r=function(t){return function(){n.setContent(t.title);n.open(e,t)}};for(var i=0;i<t.length;i++){var s=t[i],o=new google.maps.LatLng(s[1],s[2]),u=new google.maps.Marker({position:o,map:e,icon:s[3],title:s[0]});google.maps.event.addListener(u,"click",r(u))}},t=new google.maps.LatLng(40.70562,-73.972558),n={zoom:13,scrollwheel:!1,mapTypeControl:!1,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP},r=new google.maps.Map(document.getElementById("map_canvas"),n),i={path:"M 125,5 155,90 245,90 175,145 200,230 125,180 50,230 75,145 5,90 95,90 z",fillColor:"yellow",fillOpacity:1,scale:.1,strokeColor:"#c73c30",strokeWeight:2},s=[["Brooklyn Winery",40.717371,-73.955123,i],["Brooklyn Bridge Marriott",40.694306,-73.988206]];e(r,s);google.maps.event.addDomListener(window,"resize",function(){r.setCenter(t)})}};$(document).ready(function(){$(".scroll").click(function(e){e.preventDefault();Ws.lastHash=this.hash;$("html,body").animate({scrollTop:$(this.hash).offset().top-$("#site_nav").height()},500,"swing",function(){Ws.lastHash=""});Ws.highlightSelected()})});$(window).scroll(function(){Modernizr.touch||Ws.parallax();var e=!1;Ws.lastHash.length&&(e=Ws.highlightSelected());if(e)return;var t=$(window).scrollTop(),n=$(document).height()-($(window).scrollTop()+$(window).height()),r=t+$("#site_nav").height()+$("section").first().height();if(t===0){$("nav a.active").removeClass("active");$("nav a:first").addClass("active")}else if(n<1){$("nav a.active").removeClass("active");$("nav a:last").addClass("active")}else $("section").each(function(e){if(r>=$(this).position().top){$("nav a.active").removeClass("active");$("nav a").eq(e).addClass("active")}})}).scroll();$(window).load(Ws.initializeMaps);